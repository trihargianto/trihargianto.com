---
import { getCollection } from "astro:content";

import BaseLayout from "../layouts/BaseLayout.astro";
import ProjectCardInteractive from "../components/ProjectCardInteractive";

const allProjects = await getCollection("project");

const projects = allProjects.map((project) => ({
  title: project.data.title,
  slug: project.id,
  description: project.data.description,
  category: project.data.category,
  demoLink: project.data.demoLink,
  githubLink: project.data.githubLink,
  tags: project.data.tags,
}));
---

<BaseLayout
  pageTitle="Pet Projects | Tri Hargianto"
  pageDescription="Some of my work that I worked on my spare time for fun"
>
  <div class="mb-8" data-animate="fadeInUp">
    <h1 class="mb-0">Pet Projects üêà</h1>
    <p class="mt-1 text-sm text-gray-500 sm:text-base">
      Some of my work that I worked on my spare time for fun
    </p>
  </div>

  <div class="-m-2 flex flex-wrap sm:flex-row" data-stagger="true">
    {
      projects.map((item) => (
        <div class="w-full p-2 md:w-1/2 lg:w-1/3">
          <ProjectCardInteractive
            client:load
            name={item.title}
            description={item.description}
            category={item.category}
            demoLink={item.demoLink}
            githubLink={item.githubLink}
            tags={item.tags}
          />
        </div>
      ))
    }
  </div>
</BaseLayout>

<script>
  import { initScrollReveal } from "../utils/scrollReveal";

  // Initialize scroll reveal animations
  document.addEventListener("DOMContentLoaded", () => {
    initScrollReveal();
  });

  // Re-initialize on Astro page transitions
  document.addEventListener("astro:page-load", () => {
    initScrollReveal();
  });
</script>
